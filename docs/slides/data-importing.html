<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Katie Schuler">
<meta name="dcterms.date" content="2024-09-10">

<title>Data Import and Tidy – DataSci for Lang &amp; Mind</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../include/webex.css">
</head>

<body class="nav-sidebar docked slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">
      DataSci for Lang &amp; Mind
      </li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">DataSci for Lang &amp; Mind</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html#resources" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../index.html#materials" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Materials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html#study-guides" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Study guides</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html#problem-sets" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem sets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html#exams" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exams</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html#lab-exercises" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab exercises</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html#schedule" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#announcements" id="toc-announcements" class="nav-link active" data-scroll-target="#announcements"><span class="header-section-number">0.1</span> Announcements</a></li>
  <li><a href="#last-week" id="toc-last-week" class="nav-link" data-scroll-target="#last-week"><span class="header-section-number">0.2</span> Last week</a></li>
  <li><a href="#you-are-here" id="toc-you-are-here" class="nav-link" data-scroll-target="#you-are-here"><span class="header-section-number">0.3</span> You are <code>here</code></a></li>
  <li><a href="#data-science-workflow" id="toc-data-science-workflow" class="nav-link" data-scroll-target="#data-science-workflow"><span class="header-section-number">0.4</span> Data science workflow</a></li>
  <li><a href="#overview-for-today" id="toc-overview-for-today" class="nav-link" data-scroll-target="#overview-for-today"><span class="header-section-number">0.5</span> Overview for today</a></li>
  <li><a href="#tidyverse" id="toc-tidyverse" class="nav-link" data-scroll-target="#tidyverse"><span class="header-section-number">1</span> Tidyverse</a>
  <ul class="collapse">
  <li><a href="#tidyverse-1" id="toc-tidyverse-1" class="nav-link" data-scroll-target="#tidyverse-1"><span class="header-section-number">1.1</span> Tidyverse</a></li>
  <li><a href="#loading-the-tidyverse" id="toc-loading-the-tidyverse" class="nav-link" data-scroll-target="#loading-the-tidyverse"><span class="header-section-number">1.2</span> Loading the tidyverse</a></li>
  <li><a href="#tidy-data" id="toc-tidy-data" class="nav-link" data-scroll-target="#tidy-data"><span class="header-section-number">1.3</span> Tidy data</a></li>
  <li><a href="#tidy-data-1" id="toc-tidy-data-1" class="nav-link" data-scroll-target="#tidy-data-1"><span class="header-section-number">1.4</span> Tidy data</a></li>
  </ul></li>
  <li><a href="#purr" id="toc-purr" class="nav-link" data-scroll-target="#purr"><span class="header-section-number">2</span> <code>purr</code></a>
  <ul class="collapse">
  <li><a href="#purr-1" id="toc-purr-1" class="nav-link" data-scroll-target="#purr-1"><span class="header-section-number">2.1</span> <code>purr</code></a></li>
  <li><a href="#the-map_-functions" id="toc-the-map_-functions" class="nav-link" data-scroll-target="#the-map_-functions"><span class="header-section-number">2.2</span> The <code>map_*()</code> functions</a></li>
  <li><a href="#the-map_-functions-1" id="toc-the-map_-functions-1" class="nav-link" data-scroll-target="#the-map_-functions-1"><span class="header-section-number">2.3</span> The <code>map_*()</code> functions</a></li>
  <li><a href="#map-use-case" id="toc-map-use-case" class="nav-link" data-scroll-target="#map-use-case"><span class="header-section-number">2.4</span> <code>map</code> use case</a></li>
  </ul></li>
  <li><a href="#tibble" id="toc-tibble" class="nav-link" data-scroll-target="#tibble"><span class="header-section-number">3</span> <code>tibble</code></a>
  <ul class="collapse">
  <li><a href="#tibble-1" id="toc-tibble-1" class="nav-link" data-scroll-target="#tibble-1"><span class="header-section-number">3.1</span> <code>tibble</code></a></li>
  <li><a href="#tibble-2" id="toc-tibble-2" class="nav-link" data-scroll-target="#tibble-2"><span class="header-section-number">3.2</span> <code>tibble</code></a></li>
  <li><a href="#create-a-tibble" id="toc-create-a-tibble" class="nav-link" data-scroll-target="#create-a-tibble"><span class="header-section-number">3.3</span> Create a <code>tibble</code></a></li>
  <li><a href="#test-if-tibble" id="toc-test-if-tibble" class="nav-link" data-scroll-target="#test-if-tibble"><span class="header-section-number">3.4</span> Test if <code>tibble</code></a></li>
  <li><a href="#data.frame-v-tibble" id="toc-data.frame-v-tibble" class="nav-link" data-scroll-target="#data.frame-v-tibble"><span class="header-section-number">3.5</span> <code>data.frame</code> v <code>tibble</code></a></li>
  </ul></li>
  <li><a href="#readr" id="toc-readr" class="nav-link" data-scroll-target="#readr"><span class="header-section-number">4</span> <code>readr</code></a>
  <ul class="collapse">
  <li><a href="#readr-1" id="toc-readr-1" class="nav-link" data-scroll-target="#readr-1"><span class="header-section-number">4.1</span> <code>readr</code></a></li>
  <li><a href="#rectangular-data" id="toc-rectangular-data" class="nav-link" data-scroll-target="#rectangular-data"><span class="header-section-number">4.2</span> Rectangular data</a></li>
  <li><a href="#getting-a-csv-file-from-google-sheets" id="toc-getting-a-csv-file-from-google-sheets" class="nav-link" data-scroll-target="#getting-a-csv-file-from-google-sheets"><span class="header-section-number">4.3</span> Getting a CSV file from google sheets</a></li>
  <li><a href="#read_" id="toc-read_" class="nav-link" data-scroll-target="#read_"><span class="header-section-number">4.4</span> <code>read_*()</code></a></li>
  <li><a href="#supported-file-types-read_" id="toc-supported-file-types-read_" class="nav-link" data-scroll-target="#supported-file-types-read_"><span class="header-section-number">4.5</span> 7 supported file types, <code>read_*()</code></a></li>
  <li><a href="#read-csv-files" id="toc-read-csv-files" class="nav-link" data-scroll-target="#read-csv-files"><span class="header-section-number">4.6</span> Read <code>csv</code> files</a></li>
  <li><a href="#col_types-column-specification" id="toc-col_types-column-specification" class="nav-link" data-scroll-target="#col_types-column-specification"><span class="header-section-number">4.7</span> <code>col_types</code> column specification</a></li>
  <li><a href="#reading-more-complex-files" id="toc-reading-more-complex-files" class="nav-link" data-scroll-target="#reading-more-complex-files"><span class="header-section-number">4.8</span> Reading more complex files</a></li>
  <li><a href="#writing-to-a-file" id="toc-writing-to-a-file" class="nav-link" data-scroll-target="#writing-to-a-file"><span class="header-section-number">4.9</span> Writing to a file</a></li>
  </ul></li>
  <li><a href="#common-problems-readr" id="toc-common-problems-readr" class="nav-link" data-scroll-target="#common-problems-readr"><span class="header-section-number">5</span> Common problems <code>readr</code></a>
  <ul class="collapse">
  <li><a href="#data-set-containing-3-common-problems" id="toc-data-set-containing-3-common-problems" class="nav-link" data-scroll-target="#data-set-containing-3-common-problems"><span class="header-section-number">5.1</span> Data set containing 3 common problems</a></li>
  <li><a href="#column-contains-unexpected-values" id="toc-column-contains-unexpected-values" class="nav-link" data-scroll-target="#column-contains-unexpected-values"><span class="header-section-number">5.2</span> Column contains unexpected values</a></li>
  <li><a href="#missing-values-are-not-na" id="toc-missing-values-are-not-na" class="nav-link" data-scroll-target="#missing-values-are-not-na"><span class="header-section-number">5.3</span> Missing values are not <code>NA</code></a></li>
  <li><a href="#column-names-have-spaces" id="toc-column-names-have-spaces" class="nav-link" data-scroll-target="#column-names-have-spaces"><span class="header-section-number">5.4</span> Column names have spaces</a></li>
  </ul></li>
  <li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions"><span class="header-section-number">6</span> Questions?</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="data-importing.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Import and Tidy</h1>
<p class="subtitle lead">Data Science for Studying Language and the Mind</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Katie Schuler </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 10, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="announcements" class="level2 smaller" data-number="0.1">
<h2 class="smaller anchored" data-number="0.1" data-anchor-id="announcements"><span class="header-section-number">0.1</span> Announcements</h2>
<ul>
<li>Course selection period ends today!</li>
<li>Please email me by 1pm if you require any permits or changes
<ul>
<li>Our office admin leaves at 4 and I am not able to see or issue permits myself</li>
</ul></li>
<li>Pset 1 was due yesterday at noon
<ul>
<li>Solutions will be posted on Thursday at noon</li>
<li>If you forgot to turn it in, please email me asap to request an extension to Thursday</li>
</ul></li>
<li>If you are new to the class, please see me after class
<ul>
<li>We will try to schedule a remediation day to help you get caught up</li>
</ul></li>
</ul>
</section>
<section id="last-week" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="last-week"><span class="header-section-number">0.2</span> Last week</h2>
<ul>
<li>Data visualization with <code>ggplot2</code></li>
<li>Let’s go back to revisit one thing we missed! <a href="../slides/data-visualization-2.html#shortcuts">Shortcuts</a></li>
</ul>
</section>
<section id="you-are-here" class="level2 smaller" data-number="0.3">
<h2 class="smaller anchored" data-number="0.3" data-anchor-id="you-are-here"><span class="header-section-number">0.3</span> You are <code>here</code></h2>
<div class="columns">
<div class="column" style="width:33%;">
<section id="data-science-with-r" class="level5" data-number="0.3.0.0.1">
<h5 data-number="0.3.0.0.1" class="anchored" data-anchor-id="data-science-with-r"><span class="header-section-number">0.3.0.0.1</span> Data science with R</h5>
<div class="nonincremental">
<ul>
<li>R basics</li>
<li>Data visualization</li>
<li><code>Data wrangling</code></li>
</ul>
</div>
</section>
</div><div class="column" style="width:33%;">
<section id="stats-model-buidling" class="level5" data-number="0.3.0.0.2">
<h5 data-number="0.3.0.0.2" class="anchored" data-anchor-id="stats-model-buidling"><span class="header-section-number">0.3.0.0.2</span> Stats &amp; Model buidling</h5>
<div class="nonincremental">
<ul>
<li>Sampling distribution</li>
<li>Hypothesis testing</li>
<li>Model specification</li>
<li>Model fitting</li>
<li>Model accuracy</li>
<li>Model reliability</li>
</ul>
</div>
</section>
</div><div class="column" style="width:33%;">
<section id="more-advanced" class="level5" data-number="0.3.0.0.3">
<h5 data-number="0.3.0.0.3" class="anchored" data-anchor-id="more-advanced"><span class="header-section-number">0.3.0.0.3</span> More advanced</h5>
<div class="nonincremental">
<ul>
<li>Classification</li>
<li>Inference for regression</li>
<li>Mixed-effect models</li>
</ul>
</div>
</section>
</div>
</div>
</section>
<section id="data-science-workflow" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="data-science-workflow"><span class="header-section-number">0.4</span> Data science workflow</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assests/images/data-science-workflow.png" class="img-fluid figure-img"></p>
<figcaption>Data Science Workflow by R4DS</figcaption>
</figure>
</div>
</section>
<section id="overview-for-today" class="level2" data-number="0.5">
<h2 data-number="0.5" class="anchored" data-anchor-id="overview-for-today"><span class="header-section-number">0.5</span> Overview for today</h2>
<ul>
<li>Tidyverse</li>
<li>Tidy data</li>
<li><code>purr</code> - functional programming</li>
<li><code>tibble</code> - modern data.frame</li>
<li><code>readr</code> - reading data</li>
</ul>
</section>
<section id="tidyverse" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Tidyverse</h1>
<blockquote class="blockquote">
<p>The tidyverse is an opinionated collection of R packages designed for data science. All packages share an underlying design philosophy, grammar, and data structures.</p>
<p><a href="https://www.tidyverse.org/">Tidyverse package docs</a></p>
</blockquote>
<section id="tidyverse-1" class="level2 smaller" data-number="1.1">
<h2 class="smaller anchored" data-number="1.1" data-anchor-id="tidyverse-1"><span class="header-section-number">1.1</span> Tidyverse</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><code>ggplot2</code> - for data visualization</li>
<li><code>dplyr</code> - for data wrangling</li>
<li><code>readr</code> - for reading data</li>
<li><code>tibble</code> - for modern data frames</li>
<li><code>stringr</code>: for string manipulation</li>
<li><code>forcats</code>: for dealing with factors</li>
<li><code>tidyr</code>: for data tidying</li>
<li><code>purrr</code>: for functional programming</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assests/images/tidyverse-hexlogos.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Tidyverse hex logos from www.tidyverse.org</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="loading-the-tidyverse" class="level2 smaller" data-number="1.2">
<h2 class="smaller anchored" data-number="1.2" data-anchor-id="loading-the-tidyverse"><span class="header-section-number">1.2</span> Loading the tidyverse</h2>
<p>Already installed on Google Colab’s R kernel:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<p>Returns a message in Google Colab:</p>
<ul>
<li>a list of packages loaded</li>
<li>a warning of potential name conflicts</li>
</ul>
</section>
<section id="tidy-data" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="tidy-data"><span class="header-section-number">1.3</span> Tidy data</h2>
<p>Tidyverse makes use of tidy data, a standard way of structuring datasets:</p>
<ol type="1">
<li>each variable forms a <strong>column</strong>; each column forms a variable</li>
<li>each observation forms a <strong>row</strong>; each row forms an observation</li>
<li>value is a <strong>cell</strong>; each cell is a single value</li>
</ol>
</section>
<section id="tidy-data-1" class="level2 smaller" data-number="1.4">
<h2 class="smaller anchored" data-number="1.4" data-anchor-id="tidy-data-1"><span class="header-section-number">1.4</span> Tidy data</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assests/images/tidy-data.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Visual of tidy data rules, from R for Data Science</figcaption>
</figure>
</div>
<p>Why tidy data?</p>
<ul>
<li>Because consistency and uniformity are very helpful when programming</li>
<li>Variables as columns works well for vectorized languages (R!)</li>
</ul>
</section>
</section>
<section id="purr" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> <code>purr</code></h1>
<p>Functional programming</p>
<p>to illustrate the joy of <code>tidyverse</code> and tidy data</p>
<section id="purr-1" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="purr-1"><span class="header-section-number">2.1</span> <code>purr</code></h2>
<blockquote class="blockquote">
<p>purrr enhances R’s functional programming (FP) toolkit by providing a complete and consistent set of tools for working with functions and vectors. If you’ve never heard of FP before, the best place to start is the family of map() functions which allow you to replace many for loops with code that is both more succinct and easier to read.</p>
<p><a href="https://purrr.tidyverse.org/">purrr docs</a></p>
</blockquote>
</section>
<section id="the-map_-functions" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="the-map_-functions"><span class="header-section-number">2.2</span> The <code>map_*()</code> functions</h2>
<ol type="1">
<li>Take a vector as input</li>
<li>Apply a function to each element</li>
<li>Return a new vector</li>
</ol>
</section>
<section id="the-map_-functions-1" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="the-map_-functions-1"><span class="header-section-number">2.3</span> The <code>map_*()</code> functions</h2>
<p>We say “functions” because there are 5, one for each type of vector:</p>
<ul>
<li><code>map()</code> - list</li>
<li><code>map_lgl()</code> - logical</li>
<li><code>map_int()</code> - integer</li>
<li><code>map_dbl()</code> - double</li>
<li><code>map_chr()</code> - character</li>
</ul>
</section>
<section id="map-use-case" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="map-use-case"><span class="header-section-number">2.4</span> <code>map</code> use case</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">z =</span> <span class="dv">21</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p>with copy+paste</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df<span class="sc">$</span>x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df<span class="sc">$</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df<span class="sc">$</span>z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25.5</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>with <code>map</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(df, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$x
[1] 5.5

$y
[1] 15.5

$z
[1] 25.5</code></pre>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="tibble" class="level1 page-columns page-full" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> <code>tibble</code></h1>
<p>modern data frames</p>
<section id="tibble-1" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="tibble-1"><span class="header-section-number">3.1</span> <code>tibble</code></h2>
<blockquote class="blockquote">
<p>A tibble, or tbl_df, is a modern reimagining of the data.frame, keeping what time has proven to be effective, and throwing out what is not. Tibbles are data.frames that are lazy and surly: they do less and complain more</p>
<p><a href="https://tibble.tidyverse.org/">tibble docs</a></p>
</blockquote>
</section>
<section id="tibble-2" class="level2 smaller page-columns page-full" data-number="3.2">
<h2 class="smaller anchored" data-number="3.2" data-anchor-id="tibble-2"><span class="header-section-number">3.2</span> <code>tibble</code></h2>
<p>Tibbles do less than data frames, in a good way:</p>
<ul>
<li>never changes type of input (never converts strings to factors!)</li>
<li>never changes the name of variables</li>
<li>only recycles vectors of length 1</li>
<li>never creates row names</li>
</ul>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>The take-away is that <code>data.frame</code> and <code>tibble</code> sometimes behave differently. The behavior of <code>tibble</code> makes more sense for modern data science, so we should us it instead!</p>
</div></div></section>
<section id="create-a-tibble" class="level2 smaller" data-number="3.3">
<h2 class="smaller anchored" data-number="3.3" data-anchor-id="create-a-tibble"><span class="header-section-number">3.3</span> Create a <code>tibble</code></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Coerce an existing object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
      x y    
  &lt;int&gt; &lt;chr&gt;
1     1 a    
2     2 b    
3     3 c    
4     4 d    </code></pre>
</div>
</div>
<p>Pass a column of vectors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
      x y    
  &lt;int&gt; &lt;chr&gt;
1     1 a    
2     2 b    
3     3 c    
4     4 d    </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Define row-by-row:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tribble</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>x, <span class="sc">~</span>y,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"a"</span>, <span class="dv">1</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b"</span>, <span class="dv">2</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"c"</span>, <span class="dv">3</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"d"</span>, <span class="dv">4</span> </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  x         y
  &lt;chr&gt; &lt;dbl&gt;
1 a         1
2 b         2
3 c         3
4 d         4</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="test-if-tibble" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="test-if-tibble"><span class="header-section-number">3.4</span> Test if <code>tibble</code></h2>
<p>With <code>is_tibble(x)</code> and <code>is.data.frame(x)</code></p>
<div class="columns">
<div class="column" style="width:50%;">
<p>Data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is_tibble</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.data.frame</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Tibble:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>tib <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>x, <span class="sc">~</span>y,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"a"</span>, <span class="dv">1</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b"</span>, <span class="dv">2</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"c"</span>, <span class="dv">3</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"d"</span>, <span class="dv">4</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is_tibble</span>(tib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.data.frame</span>(tib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="data.frame-v-tibble" class="level2 smaller" data-number="3.5">
<h2 class="smaller anchored" data-number="3.5" data-anchor-id="data.frame-v-tibble"><span class="header-section-number">3.5</span> <code>data.frame</code> v <code>tibble</code></h2>
<p>You will encounter 2 main differences:</p>
<ol type="1">
<li><strong>printing</strong>
<ul>
<li>by default, tibbles print the first 10 rows and all columns that fit on screen, making it easier to work with large datasets.</li>
<li>also report the type of each column (e.g.&nbsp;<code>&lt;dbl&gt;</code>, <code>&lt;chr&gt;</code>)</li>
</ul></li>
<li><strong>subsetting</strong> - tibbles are more strict than data frames, which fixes two quirks we encountered when subsetting with <code>[[</code> and <code>$</code>:
<ul>
<li>tibbles <em>never</em> do partial matching</li>
<li>they <em>always</em> generate a warning if the column you are trying to extract does not exist.</li>
</ul></li>
</ol>
</section>
</section>
<section id="readr" class="level1 page-columns page-full" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> <code>readr</code></h1>
<p>reading data</p>
<section id="readr-1" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="readr-1"><span class="header-section-number">4.1</span> <code>readr</code></h2>
<blockquote class="blockquote">
<p>The goal of readr is to provide a fast and friendly way to read rectangular data from delimited files, such as comma-separated values (CSV) and tab-separated values (TSV). It is designed to parse many types of data found in the wild, while providing an informative problem report when parsing leads to unexpected results.</p>
<p><a href="https://readr.tidyverse.org/">readr docs</a></p>
</blockquote>
</section>
<section id="rectangular-data" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="rectangular-data"><span class="header-section-number">4.2</span> Rectangular data</h2>
<div id="fig-rectangledata" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rectangledata-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../assests/images/rectangle-data.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rectangledata-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Sample csv file from R for Data Science
</figcaption>
</figure>
</div>
</section>
<section id="getting-a-csv-file-from-google-sheets" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="getting-a-csv-file-from-google-sheets"><span class="header-section-number">4.3</span> Getting a CSV file from google sheets</h2>
<ul>
<li>Let’s quickly demo how we’d do this from google sheets</li>
</ul>
</section>
<section id="read_" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="read_"><span class="header-section-number">4.4</span> <code>read_*()</code></h2>
<p>The <code>read_*()</code> functions have two important arguments:</p>
<ol type="1">
<li><code>file</code> - the path to the file</li>
<li><code>col_types</code> - a list of how each column should be converted to a specific data type</li>
</ol>
</section>
<section id="supported-file-types-read_" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="supported-file-types-read_"><span class="header-section-number">4.5</span> 7 supported file types, <code>read_*()</code></h2>
<ul>
<li><code>read_csv()</code>: comma-separated values (CSV)</li>
<li><code>read_tsv()</code>: tab-separated values (TSV)</li>
<li><code>read_csv2()</code>: semicolon-separated values</li>
<li><code>read_delim()</code>: delimited files (CSV and TSV are important special cases)</li>
<li><code>read_fwf()</code>: fixed-width files</li>
<li><code>read_table()</code>: whitespace-separated files</li>
<li><code>read_log()</code>: web log files</li>
</ul>
</section>
<section id="read-csv-files" class="level2 page-columns page-full" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="read-csv-files"><span class="header-section-number">4.6</span> Read <code>csv</code> files</h2>
<p>Path only, <code>readr</code> guesses types:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="at">file=</span><span class="st">'"https://pos.it/r4ds-students-csv"'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>. . .</p>
<p>Path and specify col_types:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">file=</span><span class="st">'"https://pos.it/r4ds-students-csv"'</span>, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">list</span>( <span class="at">x =</span> <span class="fu">col_string</span>(), <span class="at">y =</span> <span class="fu">col_skip</span>() )</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>Guessing heuristic: character &gt; date-time &gt; double &gt; logical</p>
</div></div></section>
<section id="col_types-column-specification" class="level2 smaller" data-number="4.7">
<h2 class="smaller anchored" data-number="4.7" data-anchor-id="col_types-column-specification"><span class="header-section-number">4.7</span> <code>col_types</code> column specification</h2>
<p>There are 11 column types that can be specified:</p>
<ul>
<li><code>col_logical()</code> - reads as boolean TRUE FALSE values</li>
<li><code>col_integer()</code> - reads as integer</li>
<li><code>col_double()</code> - reads as double</li>
<li><code>col_number()</code> - numeric parser that can ignore non-numbers</li>
<li><code>col_character()</code> - reads as strings</li>
<li><code>col_factor(levels, ordered = FALSE)</code> - creates factors</li>
<li><code>col_datetime(format = "")</code> - creates date-times</li>
<li><code>col_date(format = "")</code> - creates dates</li>
<li><code>col_time(format = "")</code> - creates times</li>
<li><code>col_skip()</code> - skips a column</li>
<li><code>col_guess()</code> - tries to guess the column</li>
</ul>
</section>
<section id="reading-more-complex-files" class="level2 smaller" data-number="4.8">
<h2 class="smaller anchored" data-number="4.8" data-anchor-id="reading-more-complex-files"><span class="header-section-number">4.8</span> Reading more complex files</h2>
<p>Reading more complex file types requires functions outside the tidyverse:</p>
<ul>
<li><strong>excel</strong> with <code>readxl</code> - see <a href="https://r4ds.hadley.nz/spreadsheets#excel">Spreadsheets</a> in R for Data Science</li>
<li><strong>google sheets</strong> with <code>googlesheets4</code> - see <a href="https://r4ds.hadley.nz/spreadsheets#google-sheets">Spreadsheets</a> in R for Data Science</li>
<li><strong>databases</strong> with <code>DBI</code> - see <a href="https://r4ds.hadley.nz/databases">Databases</a> in R for Data Science</li>
<li><strong>json data</strong> with <code>jsonlite</code> - see <a href="https://r4ds.hadley.nz/rectangling">Hierarchical data</a> in R for Data Science</li>
</ul>
</section>
<section id="writing-to-a-file" class="level2 page-columns page-full" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="writing-to-a-file"><span class="header-section-number">4.9</span> Writing to a file</h2>
<p>Write to a .csv file with</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(students, <span class="st">"students.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>arguments: tibble, name to give file</p>
</div></div></section>
</section>
<section id="common-problems-readr" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Common problems <code>readr</code></h1>
<section id="data-set-containing-3-common-problems" class="level2 smaller" data-number="5.1">
<h2 class="smaller anchored" data-number="5.1" data-anchor-id="data-set-containing-3-common-problems"><span class="header-section-number">5.1</span> Data set containing 3 common problems</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>students <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'https://pos.it/r4ds-students-csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 6 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): Full Name, favourite.food, mealPlan, AGE
dbl (1): Student ID

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>students</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  `Student ID` `Full Name`      favourite.food     mealPlan            AGE  
         &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;              &lt;chr&gt;               &lt;chr&gt;
1            1 Sunil Huffmann   Strawberry yoghurt Lunch only          4    
2            2 Barclay Lynn     French fries       Lunch only          5    
3            3 Jayendra Lyne    N/A                Breakfast and lunch 7    
4            4 Leon Rossini     Anchovies          Lunch only          &lt;NA&gt; 
5            5 Chidiegwu Dunkel Pizza              Breakfast and lunch five 
6            6 Güvenç Attila    Ice cream          Lunch only          6    </code></pre>
</div>
</div>
<ol type="1">
<li>Column contains unexpected values (<code>AGE</code>)</li>
<li>Missing values are not <code>NA</code> (<code>AGE</code> and <code>favorite.food</code>)</li>
<li>Column names have spaces (<code>Student ID</code> and <code>Full Name</code>)</li>
</ol>
</section>
<section id="column-contains-unexpected-values" class="level2 smaller" data-number="5.2">
<h2 class="smaller anchored" data-number="5.2" data-anchor-id="column-contains-unexpected-values"><span class="header-section-number">5.2</span> Column contains unexpected values</h2>
<p>Your dataset has a column that you expected to be <code>logical</code> or <code>double</code>, but there is a typo somewhere, so R has coerced the column into <code>character</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>students</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  `Student ID` `Full Name`      favourite.food     mealPlan            AGE  
         &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;              &lt;chr&gt;               &lt;chr&gt;
1            1 Sunil Huffmann   Strawberry yoghurt Lunch only          4    
2            2 Barclay Lynn     French fries       Lunch only          5    
3            3 Jayendra Lyne    N/A                Breakfast and lunch 7    
4            4 Leon Rossini     Anchovies          Lunch only          &lt;NA&gt; 
5            5 Chidiegwu Dunkel Pizza              Breakfast and lunch five 
6            6 Güvenç Attila    Ice cream          Lunch only          6    </code></pre>
</div>
</div>
<p>. . .</p>
<p>Solve by specifying the column type <code>col_double()</code> and then using the <code>problems()</code> function to see where R failed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>students_coerced <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> <span class="st">'https://pos.it/r4ds-students-csv'</span>, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">list</span>(<span class="at">AGE =</span> <span class="fu">col_double</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One or more parsing issues, call `problems()` on your data frame for details,
e.g.:
  dat &lt;- vroom(...)
  problems(dat)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">problems</span>(students_coerced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
    row   col expected actual file 
  &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;
1     6     5 a double five   ""   </code></pre>
</div>
</div>
</section>
<section id="missing-values-are-not-na" class="level2 smaller" data-number="5.3">
<h2 class="smaller anchored" data-number="5.3" data-anchor-id="missing-values-are-not-na"><span class="header-section-number">5.3</span> Missing values are not <code>NA</code></h2>
<p>Your dataset has missing values, but they were not coded as <code>NA</code> as R expects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>students</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  `Student ID` `Full Name`      favourite.food     mealPlan            AGE  
         &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;              &lt;chr&gt;               &lt;chr&gt;
1            1 Sunil Huffmann   Strawberry yoghurt Lunch only          4    
2            2 Barclay Lynn     French fries       Lunch only          5    
3            3 Jayendra Lyne    N/A                Breakfast and lunch 7    
4            4 Leon Rossini     Anchovies          Lunch only          &lt;NA&gt; 
5            5 Chidiegwu Dunkel Pizza              Breakfast and lunch five 
6            6 Güvenç Attila    Ice cream          Lunch only          6    </code></pre>
</div>
</div>
<p>. . .</p>
<p>Solve by adding an <code>na</code> argument (e.g.&nbsp;<code>na=c("N/A")</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>(students_nas <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> <span class="st">'https://pos.it/r4ds-students-csv'</span>, </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">na =</span> <span class="fu">c</span>(<span class="st">"N/A"</span>, <span class="st">"&lt;NA&gt;"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 6 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): Full Name, favourite.food, mealPlan, AGE
dbl (1): Student ID

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  `Student ID` `Full Name`      favourite.food     mealPlan            AGE   
         &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;              &lt;chr&gt;               &lt;chr&gt; 
1            1 Sunil Huffmann   Strawberry yoghurt Lunch only          "4"   
2            2 Barclay Lynn     French fries       Lunch only          "5"   
3            3 Jayendra Lyne    &lt;NA&gt;               Breakfast and lunch "7"   
4            4 Leon Rossini     Anchovies          Lunch only          ""    
5            5 Chidiegwu Dunkel Pizza              Breakfast and lunch "five"
6            6 Güvenç Attila    Ice cream          Lunch only          "6"   </code></pre>
</div>
</div>
</section>
<section id="column-names-have-spaces" class="level2 smaller" data-number="5.4">
<h2 class="smaller anchored" data-number="5.4" data-anchor-id="column-names-have-spaces"><span class="header-section-number">5.4</span> Column names have spaces</h2>
<p>Your dataset has column names that include spaces, breaking R’s naming rules. In these cases, R adds backticks (e.g.&nbsp;<code>`brain size`</code>);</p>
<p>. . .</p>
<p>We can use the <code>rename()</code> function to fix them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>students <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">student_id =</span> <span class="st">`</span><span class="at">Student ID</span><span class="st">`</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_name =</span> <span class="st">`</span><span class="at">Full Name</span><span class="st">`</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  student_id full_name        favourite.food     mealPlan            AGE  
       &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;              &lt;chr&gt;               &lt;chr&gt;
1          1 Sunil Huffmann   Strawberry yoghurt Lunch only          4    
2          2 Barclay Lynn     French fries       Lunch only          5    
3          3 Jayendra Lyne    N/A                Breakfast and lunch 7    
4          4 Leon Rossini     Anchovies          Lunch only          &lt;NA&gt; 
5          5 Chidiegwu Dunkel Pizza              Breakfast and lunch five 
6          6 Güvenç Attila    Ice cream          Lunch only          6    </code></pre>
</div>
</div>
<p>. . . d If we have a lot to rename and that gets annoying, see <code>janitor::clean_names()</code>.</p>
</section>
</section>
<section id="questions" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Questions?</h1>


</section>

</main> <!-- /main -->
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>